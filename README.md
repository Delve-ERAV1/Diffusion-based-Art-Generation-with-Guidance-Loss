# Project Documentation: Diffusion-based Art Generation with Guidance Loss


![image](https://github.com/Delve-ERAV1/S20/assets/11761529/8d344d6a-9577-4e04-b3ba-5f3f6fd45f58)

## Introduction

This project focuses on generating art using a diffusion-based model. The goal was to take a text prompt and generate art in five different styles. Additionally, we applied a variant of the "blue_loss" for guidance during the diffusion process to influence the generated art.

## Model Used

We utilized a smaller version of the stable diffusion model called "tiny SD". This model is smaller and more efficient due to the use of knowledge distillation. The model can be found on Huggingface under the name ["segmind/tiny-sd"](https://huggingface.co/segmind/tiny-sd).

## Implemented Losses

For the guidance loss, we implemented the following:

- **Saturation Loss**: This loss ensures that the generated images have a certain level of color intensity or vibrancy.
  
- **Symmetry Loss**: Encourages the generated images to have a symmetrical pattern.
  
- **Elastic Loss**: Ensures that the generated images have a certain level of elasticity in their patterns.
  
- **Blue Loss**: A custom loss function that was used as a reference. Encourages generated image to have the color blue.
  

## Textual Inversion Styles

We loaded five different textual inversion styles to influence the generated art. The styles are:

1. Dreams
2. Midjourney
3. Moebius
4. Style of Marc Allante
5. Wlop Style

| Dreams             | Midjourney         | Moebius            | Style of Marc Allante | Wlop Style        |
|--------------------|--------------------|--------------------|-----------------------|-------------------|
| ![dreams](https://github.com/Delve-ERAV1/S20/assets/11761529/54c9a61e-df9f-4054-835b-ec2c6ba5916c) | ![midjourney](https://github.com/Delve-ERAV1/S20/assets/11761529/30ac92f8-fc62-4aab-9221-043865c6fe7c) | ![moebius](https://github.com/Delve-ERAV1/S20/assets/11761529/2f37e402-15d1-4a74-ba85-bb1566da930e) | ![Marc-Allante](https://github.com/Delve-ERAV1/S20/assets/11761529/f838e767-ac20-4996-b5be-65c61b365ce0) | ![wlop](https://github.com/Delve-ERAV1/S20/assets/11761529/9958140a-1b62-4972-83ca-85b023e3863f) |


The loading code for these styles is as follows:

```python
pipe.load_textual_inversion("sd-concepts-library/dreams")
pipe.load_textual_inversion("sd-concepts-library/midjourney-style")
pipe.load_textual_inversion("sd-concepts-library/moebius")
pipe.load_textual_inversion("sd-concepts-library/style-of-marc-allante")
pipe.load_textual_inversion("sd-concepts-library/wlop-style")
```

## Gradio App

We built an interactive application using Gradio and deployed it to Huggingface Spaces. The app allows users to input a text prompt and generate art in the five styles mentioned above. Additionally, users can view the influence of the guidance loss on the generated art.

[Link to the Gradio App on Huggingface Spaces](https://huggingface.co/spaces/sanjanatule/stable-diffusion-guidance-loss)

## Gallery

For each style, we have displayed two images:

1. Image generated without guidance loss
2. Image generated with guidance loss

> A modern skyscraper, urban cityscape, contemporary architecture inspired by nature, ultra photorealistic, bright lighting, photorealistic 3D rendering, 8k

| Concept Name       | Image without Loss | Image with Loss   |
|--------------------|--------------------|-------------------|
| Dreams             | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/70263ba9-2943-484d-88c9-717e683dcafd) | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/9dcd9b81-ef96-4410-89be-23897d4eac3c) |
| Midjourney         | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/6862fdae-6186-467b-a5b7-04e464eccbfa) | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/acff2172-a80c-4338-8fed-4508cb1a144e) |
| Moebius            | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/620e8ef6-89c7-4ab8-89fe-427eebfcd6c4) | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/1346fe67-74a1-4ce5-8809-4a319d9ab03a) |
| Style of Marc Allante | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/b3c4a60d-8e69-4a2b-9125-84d0201b93ba) | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/f83537c3-9ab9-4d6c-b9cc-3a79ac35e163) |
| Wlop Style        | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/d2b7ac12-3136-44e4-b3ac-04afa661ea78) | ![image](https://github.com/Delve-ERAV1/S20/assets/11761529/2068741a-dbc7-4270-8063-bb5bdab9a54d) |


## Concepts Implemented

- **Diffusion-based Art Generation**: This is a technique where art is generated by simulating a diffusion process. The tiny SD model is a prime example of this.

- **Guidance Loss**: This is a custom loss function that guides the diffusion process to generate art that adheres to certain characteristics, like symmetry or saturation.

- **Textual Inversion Styles**: These are styles that are loaded into the model to influence the generated art. They act as a guiding template for the diffusion process.

## Conclusion

This project showcases the power of diffusion-based models in art generation. By applying custom guidance losses and using different styles, we can generate unique and beautiful pieces of art. The Gradio app provides an interactive way for users to experiment with different prompts and view the generated art.


### Authors
* Sanjana Tule
* Sijuade Oguntayo
